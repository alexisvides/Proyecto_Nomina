{% extends 'base.html' %}
{% block title %}Editar Empleado{% endblock %}

{% block content %}
<section class="section">
  <div class="card auth-card" style="max-width:820px;">
    <h2 class="card-title">Editar Empleado</h2>
    <p class="card-subtitle">Modifica los datos del empleado</p>

    <form class="form" method="post">
      <div class="form-group">
        <label for="codigo">Código de empleado</label>
        <input id="codigo" name="codigo" type="text" value="{{ empleado[0] }}" disabled />
        <small class="card-subtitle">El código no se puede modificar</small>
      </div>

      <div class="form-group">
        <label for="nombres">Nombres</label>
        <input id="nombres" name="nombres" type="text" value="{{ empleado[1] }}" required />
      </div>

      <div class="form-group">
        <label for="apellidos">Apellidos</label>
        <input id="apellidos" name="apellidos" type="text" value="{{ empleado[2] }}" required />
      </div>

      <div class="form-group">
        <label for="dpi">DPI (Documento de Identidad)</label>
        <input id="dpi" name="dpi" type="text" value="{{ empleado[3] }}" required />
      </div>

      <div class="form-group">
        <label for="correo">Correo</label>
        <input id="correo" name="correo" type="email" value="{{ empleado[9] if empleado[9] else '' }}" placeholder="correo@empresa.com" />
      </div>

      <div class="form-group">
        <label for="igss">Número IGSS</label>
        <input id="igss" name="igss" type="text" value="{{ empleado[7] if empleado[7] else '' }}" />
      </div>

      <div class="form-group">
        <label for="salario">Salario base</label>
        <input id="salario" name="salario" type="number" step="0.01" min="0" value="{{ empleado[6] }}" required />
      </div>

      <div class="form-group">
        <label for="fecha_inicio">Fecha de inicio (contratación)</label>
        <input id="fecha_inicio" name="fecha_inicio" type="date" 
               value="{{ empleado[4].strftime('%Y-%m-%d') if empleado[4] else '' }}" required />
      </div>

      <div class="form-group">
        <label for="fecha_fin">Fecha de fin (opcional)</label>
        <input id="fecha_fin" name="fecha_fin" type="date" 
               value="{{ empleado[5].strftime('%Y-%m-%d') if empleado[5] else '' }}" />
      </div>

      <div class="form-group">
        <label for="fecha_nacimiento">Fecha de nacimiento (opcional)</label>
        <input id="fecha_nacimiento" name="fecha_nacimiento" type="date" 
               value="{{ empleado[8].strftime('%Y-%m-%d') if empleado[8] else '' }}" />
      </div>

      <div class="form-group">
        <label for="puesto">Puesto / Departamento</label>
        <div class="custom-select-wrapper">
          <select id="puesto" name="id_puesto" class="custom-select">
            <option value="">-- Seleccionar Puesto --</option>
            {% for depto, puestos in puestos_por_depto.items() %}
              <optgroup label="{{ depto }}">
                {% for puesto in puestos %}
                  <option value="{{ puesto[0] }}" data-departamento="{{ depto }}" {% if empleado[10] and empleado[10] == puesto[0] %}selected{% endif %}>
                    {{ puesto[1] }}
                  </option>
                {% endfor %}
              </optgroup>
            {% endfor %}
          </select>
          <div class="select-arrow">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="6 9 12 15 18 9"/>
            </svg>
          </div>
        </div>
        <small class="card-subtitle">Selecciona el puesto y departamento del empleado</small>
      </div>

      <style>
        .custom-select-wrapper {
          position: relative;
        }
        
        .custom-select {
          width: 100%;
          padding: 12px 40px 12px 16px;
          background: #0f1a2e;
          border: 1px solid #1f2a44;
          border-radius: 8px;
          color: #e2e8f0;
          font-size: 15px;
          cursor: pointer;
          transition: all 0.2s;
          appearance: none;
          -webkit-appearance: none;
          -moz-appearance: none;
        }
        
        .custom-select:hover {
          border-color: #3b82f6;
          background: #1a2942;
        }
        
        .custom-select:focus {
          outline: none;
          border-color: #3b82f6;
          box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .custom-select option {
          padding: 10px;
          background: #0f1a2e;
          color: #e2e8f0;
        }
        
        .custom-select optgroup {
          font-weight: 700;
          font-size: 13px;
          color: #94a3b8;
          background: #0a1120;
          padding: 8px 12px;
          margin: 4px 0;
        }
        
        /* Colores por departamento */
        .custom-select option[data-departamento="Recursos Humanos"] {
          background: linear-gradient(90deg, rgba(59, 130, 246, 0.1) 0%, transparent 100%);
          border-left: 3px solid #3b82f6;
          padding-left: 13px;
        }
        
        .custom-select option[data-departamento="Finanzas"] {
          background: linear-gradient(90deg, rgba(16, 185, 129, 0.1) 0%, transparent 100%);
          border-left: 3px solid #10b981;
          padding-left: 13px;
        }
        
        .custom-select option[data-departamento="Tecnología"] {
          background: linear-gradient(90deg, rgba(139, 92, 246, 0.1) 0%, transparent 100%);
          border-left: 3px solid #8b5cf6;
          padding-left: 13px;
        }
        
        .custom-select option[data-departamento="Ventas"] {
          background: linear-gradient(90deg, rgba(239, 68, 68, 0.1) 0%, transparent 100%);
          border-left: 3px solid #ef4444;
          padding-left: 13px;
        }
        
        .custom-select option[data-departamento="Marketing"] {
          background: linear-gradient(90deg, rgba(236, 72, 153, 0.1) 0%, transparent 100%);
          border-left: 3px solid #ec4899;
          padding-left: 13px;
        }
        
        .custom-select option[data-departamento="Operaciones"] {
          background: linear-gradient(90deg, rgba(245, 158, 11, 0.1) 0%, transparent 100%);
          border-left: 3px solid #f59e0b;
          padding-left: 13px;
        }
        
        .custom-select option[data-departamento="Legal"] {
          background: linear-gradient(90deg, rgba(100, 116, 139, 0.1) 0%, transparent 100%);
          border-left: 3px solid #64748b;
          padding-left: 13px;
        }
        
        .custom-select option[data-departamento="Administración"] {
          background: linear-gradient(90deg, rgba(6, 182, 212, 0.1) 0%, transparent 100%);
          border-left: 3px solid #06b6d4;
          padding-left: 13px;
        }
        
        .select-arrow {
          position: absolute;
          right: 12px;
          top: 50%;
          transform: translateY(-50%);
          pointer-events: none;
          color: #94a3b8;
          transition: transform 0.2s;
        }
        
        .custom-select:focus + .select-arrow {
          color: #3b82f6;
          transform: translateY(-50%) rotate(180deg);
        }
      </style>

      

      <div style="display:flex; gap:10px;">
        <button class="btn btn-primary" type="submit">Actualizar</button>
        <a class="btn btn-outline" href="{{ url_for('empleados_listado') }}">Cancelar</a>
      </div>
    </form>
  </div>
</section>
{% endblock %}

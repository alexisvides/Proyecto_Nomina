{% extends "base.html" %}
{% block content %}
<h1> Generaci√≥n de Comprobantes y Recibos</h1>

<form method="post" action="{{ url_for('comprobantes_listado') }}">
  <div class="row">
    <div class="col-md-5">
      <label for="empleado">Empleado:</label>
      <select name="empleado" id="empleado" class="form-control">
        <option value="">-- Seleccionar --</option>
        {% if empleados %}
          {% for e in empleados %}
            <option value="{{ e[0] }}">{{ e[1] }}</option>
          {% endfor %}
        {% else %}
          <option value="">(No hay empleados con n√≥mina generada)</option>
        {% endif %}
      </select>
    </div>

    <div class="col-md-7 mt-4">
      <button type="submit" name="accion" value="individual" class="btn btn-success">Generar Individual</button>
      <button type="submit" name="accion" value="masiva" class="btn btn-primary">Generar Masiva</button>
      <button type="submit" name="accion" value="historial" class="btn btn-secondary">Ver Historial</button>
    </div>
  </div>
</form>

<hr>

{% if comprobantes %}
<h3>üìú Historial de Comprobantes Emitidos</h3>
<table class="table table-striped">
  <thead>
    <tr>
      <th>ID</th>
      <th>Empleado</th>
      <th>Fecha Emisi√≥n</th>
      <th>Firma Digital</th>
    </tr>
  </thead>
  <tbody>
    {% for c in comprobantes %}
    <tr>
      <td>{{ c[0] }}</td>
      <td>{{ c[1] }}</td>
      <td>{{ c[2] }}</td>
      <td><code>{{ c[3] }}</code></td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<div class="alert alert-info">No hay comprobantes registrados todav√≠a.</div>
{% endif %}

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
  <div class="mt-3">
    {% for category, msg in messages %}
    <div class="alert alert-{{ category }}">{{ msg }}</div>
    {% endfor %}
  </div>
  {% endif %}
{% endwith %}
{% endblock %}